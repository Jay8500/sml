<div class="grid">
    <div class="col-12">
        <div class="card">
            <div class="flex justify-content-between flex-wrap">
                <div class="flex align-items-center justify-content-center w-22rem h-2rem font-bold border-round m-2">
                    Disbursements ( Approved loans )
                </div>
                <div class="flex align-items-center justify-content-center w-0rem h-0 font-bold border-round m-1">
                    <!-- 2 -->
                </div>
                <!-- <div class="flex align-items-center justify-content-center w-10rem h-2rem font-bold border-round m-2">
                    <button pButton pRipple label="Add new" [loading]=false class="p-button-success"
                        (click)="onClick(null,'NEW')"></button>
                </div> -->
            </div>


            <p-table #dt1 [value]="crudGrid" dataKey="id" [rows]="10" [loading]="loading" [rowHover]="true"
                styleClass="p-datatable-gridlines" [showCurrentPageReport]="true" [paginator]="false"
                responsiveLayout="scroll">
                <ng-template pTemplate="header">
                    <tr>
                        <th style="min-width: 5rem; background-color: rgb(91, 91, 182);" class="text-white">
                            <div class="flex justify-content-between align-items-center">
                                Action

                            </div>
                        </th>
                        <th style="min-width: 12rem ; background-color: rgb(91, 91, 182);" class="text-white">
                            <div class="flex justify-content-between align-items-center">
                                SMT CODE
                                <p-columnFilter type="text" field="smtcode" display="menu"
                                    placeholder="Search by SML CODE"></p-columnFilter>
                            </div>
                        </th>
                        <th style="min-width: 12rem ; background-color: rgb(91, 91, 182);" class="text-white">
                            <div class="flex justify-content-between align-items-center">
                                Disbursement Status
                                <!-- <p-columnFilter type="text" field="approvalstatus" display="menu"
                                    placeholder="Search by Approval Status"></p-columnFilter> -->
                            </div>
                        </th>
                        <th style="min-width: 15rem ; background-color: rgb(91, 91, 182);" class="text-white">
                            <div class="flex justify-content-between align-items-center">
                                Disbursement Remarks
                                <!-- <p-columnFilter type="text" field="approvalstatus" display="menu"
                                    placeholder="Search by Approval Status"></p-columnFilter> -->
                            </div>
                        </th>
                        <th style="min-width: 12rem ; background-color: rgb(91, 91, 182);" class="text-white">
                            <div class="flex justify-content-between align-items-center">
                                Payment Mode
                                <!-- <p-columnFilter type="text" field="approvalstatus" display="menu"
                                    placeholder="Search by Approval Status"></p-columnFilter> -->
                            </div>
                        </th>

                        <th style="min-width: 12rem ; background-color: rgb(91, 91, 182);" class="text-white">
                            <div class="flex justify-content-between align-items-center">
                                Approval Remarks
                                <!-- <p-columnFilter type="text" field="approvalstatus" display="menu"
									placeholder="Search by Approval Status"></p-columnFilter> -->
                            </div>
                        </th>

                        <th style="min-width: 12rem ; background-color: rgb(91, 91, 182);" class="text-white">
                            <div class="flex justify-content-between align-items-center">
                                Branch
                                <p-columnFilter type="text" field="branchName" display="menu"
                                    placeholder="Search by Branches"></p-columnFilter>
                            </div>
                        </th>
                        <th style="min-width: 22rem ; background-color: rgb(91, 91, 182);" class="text-white">
                            <div class="flex justify-content-between align-items-center">
                                Borrower Name
                                <p-columnFilter type="text" field="borrower" display="menu"
                                    placeholder="Search by name"></p-columnFilter>
                            </div>
                        </th>
                        <th style="min-width: 12rem ; background-color: rgb(91, 91, 182);" class="text-white">
                            <div class="flex justify-content-between align-items-center">
                                House Type
                                <p-columnFilter type="text" field="housetypeName" display="menu"
                                    placeholder="Search by House type"></p-columnFilter>
                            </div>
                        </th>
                        <th style="min-width: 12rem ; background-color: rgb(91, 91, 182);" class="text-white">
                            <div class="flex justify-content-between align-items-center">
                                Product Type
                                <p-columnFilter type="text" field="prodtypeName" display="menu"
                                    placeholder="Search by Product type"></p-columnFilter>
                            </div>
                        </th>
                        <th style="min-width: 12rem ; background-color: rgb(91, 91, 182);" class="text-white">
                            <div class="flex justify-content-between align-items-center">
                                Deposit
                                <p-columnFilter type="text" field="depositName" display="menu"
                                    placeholder="Search by Deposit List"></p-columnFilter>
                            </div>
                        </th>
                        <th style="min-width: 12rem ; background-color: rgb(91, 91, 182);" class="text-white">
                            <div class="flex justify-content-between align-items-center">
                                Loan Amount
                                <p-columnFilter type="text" field="loanamount" display="menu"
                                    placeholder="Search by Loan amount"></p-columnFilter>
                            </div>
                        </th>
                        <th style="min-width: 12rem ; background-color: rgb(91, 91, 182);" class="text-white">
                            <div class="flex justify-content-between align-items-center">
                                Repay Mode
                                <p-columnFilter type="text" field="country.name" display="menu"
                                    placeholder="Search by Loan loanscheduleName"></p-columnFilter>
                            </div>
                        </th>
                        <th style="min-width: 12rem ; background-color: rgb(91, 91, 182);" class="text-white">
                            <div class="flex justify-content-between align-items-center">
                                Loan Tenure
                                <p-columnFilter type="text" field="tenureName" display="menu"
                                    placeholder="Search by Loan tenure "></p-columnFilter>
                            </div>
                        </th>
                        <th style="min-width: 12rem ; background-color: rgb(91, 91, 182);" class="text-white">
                            <div class="flex justify-content-between align-items-center">
                                Bank
                                <p-columnFilter type="text" field="bankname" display="menu"
                                    placeholder="Search by Bank"></p-columnFilter>
                            </div>
                        </th>
                        <th style="min-width: 12rem ; background-color: rgb(91, 91, 182);" class="text-white">
                            <div class="flex justify-content-between align-items-center">
                                Account No
                                <p-columnFilter type="text" field="accountno" display="menu"
                                    placeholder="Search by Account no"></p-columnFilter>
                            </div>
                        </th>
                        <th style="min-width: 12rem ; background-color: rgb(91, 91, 182);" class="text-white">
                            <div class="flex justify-content-between align-items-center">
                                Bank Account Name
                                <p-columnFilter type="text" field="accountname" display="menu"
                                    placeholder="Search by Bank Account Name"></p-columnFilter>
                            </div>
                        </th>
                        <th style="min-width: 12rem ; background-color: rgb(91, 91, 182);" class="text-white">
                            <div class="flex justify-content-between align-items-center">
                                IFSC Code
                                <p-columnFilter type="text" field="ifsc" display="menu"
                                    placeholder="Search by IFSC Code"></p-columnFilter>
                            </div>
                        </th>
                        <th style="min-width: 12rem ; background-color: rgb(91, 91, 182);" class="text-white">
                            <div class="flex justify-content-between align-items-center">
                                Surity Name
                                <p-columnFilter type="text" field="surityname" display="menu"
                                    placeholder="Search by Surity Name"></p-columnFilter>
                            </div>
                        </th>
                        <th style="min-width: 12rem ; background-color: rgb(91, 91, 182);" class="text-white">
                            <div class="flex justify-content-between align-items-center">
                                Surity Aadhar
                                <p-columnFilter type="text" field="surityaadhar" display="menu"
                                    placeholder="Search by Suriy Aadhar"></p-columnFilter>
                            </div>
                        </th>
                        <th style="min-width: 12rem ; background-color: rgb(91, 91, 182);" class="text-white">
                            <div class="flex justify-content-between align-items-center">
                                House type
                                <p-columnFilter type="text" field="surityhousetypeName" display="menu"
                                    placeholder="Search by House type"></p-columnFilter>
                            </div>
                        </th>
                        <th style="min-width: 12rem ; background-color: rgb(91, 91, 182);" class="text-white">
                            <div class="flex justify-content-between align-items-center">
                                Contact no
                                <p-columnFilter type="text" field="active" display="menu"
                                    placeholder="Search by Contact no"></p-columnFilter>
                            </div>
                        </th>
                        <th style="min-width: 12rem ; background-color: rgb(91, 91, 182);" class="text-white">
                            <div class="flex justify-content-between align-items-center">
                                Surity Aadhar
                                <p-columnFilter type="text" field="surityaadhar" display="menu"
                                    placeholder="Search by Suriy Aadhar"></p-columnFilter>
                            </div>
                        </th>
                        <th style="min-width: 12rem; background-color: rgb(91, 91, 182);" class="text-white">
                            <div class="flex justify-content-between align-items-center">
                                Description
                                <p-columnFilter type="text" field="description" display="menu"
                                    placeholder="Search by Suriy Description"></p-columnFilter>
                            </div>
                        </th>
                        <th style="min-width: 12rem; background-color: rgb(91, 91, 182);" class="text-white">
                            <div class="flex justify-content-between align-items-center">
                                Status
                                <p-columnFilter type="text" field="status" display="menu"
                                    placeholder="Search by Suriy Status"></p-columnFilter>
                            </div>
                        </th>
                    </tr>
                </ng-template>
                <ng-template pTemplate="body" let-customer>
                    <tr>
                        <td>
                            <div class="flex justify-content-center flex-wrap">
                                <div class="flex align-items-center  ml-1"
                                    *ngIf="!['A'].includes(customer.disbursementstatus)"
                                    (click)="onClick(customer, 'VIEW')">
                                    <i class="pi pi-eye"></i>
                                </div>
                                <div class="flex align-items-center 
								 ml-1" (click)="onClick(customer, 'EDIT')" *ngIf="!['P','A','R','C'].includes(customer.approvalstatus)">
                                    <i class="pi pi-file-edit"></i>
                                </div>

                            </div>
                        </td>
                        <td>
                            {{customer.smtcode}}
                        </td>
                        <td>
                            <span *ngIf="customer.disbursementstatus == 'A'"
                                [class]="'order-badge order-delivered'">Disbursed</span>
                            <span *ngIf="customer.disbursementstatus == 'C'"
                                [class]="'order-badge order-cancelled'">Cancel</span>
                        </td>
                        <td>
                            {{ customer.disbursementstatusremarks}}
                        </td>
                        <td>
                            {{customer.paymenttype}}
                        </td>
                        <td>
                            {{customer.approvalremarks}}
                        </td>

                        <td>
                            {{customer.branchName}}
                        </td>
                        <td>
                            {{customer.borrower}}
                        </td>

                        <td>
                            {{customer.housetypeName}}
                        </td>
                        <td>
                            {{customer.prodtypeName}}
                        </td>
                        <td>
                            {{customer.depositName}}
                        </td>
                        <td>
                            {{customer.loanAmountName}}
                            <!-- {{customer.loanamount}} -->
                        </td>
                        <td>
                            {{customer.loanscheduleName}}
                        </td>
                        <td>
                            {{customer.tenureName}}
                        </td>
                        <td>
                            {{customer.bankname}}
                        </td>
                        <td>
                            {{customer.accountno}}
                        </td>
                        <td>
                            {{customer.accountname}}
                        </td>
                        <td>
                            {{customer.ifsc}}
                        </td>
                        <td>
                            {{customer.surityname}}
                        </td>
                        <td>
                            {{customer.surityaadhar}}
                        </td>
                        <td>
                            {{customer.surityhousetypeName}}
                        </td>
                        <td>
                            {{customer.contactnumber}}
                        </td>
                        <td>
                            {{customer.surityaadhar}}
                        </td>
                        <td>
                            {{customer.description}}
                        </td>

                        <td>

                            <span *ngIf="customer.active == true"
                                [class]="'customer-badge status-qualified'">Active</span>
                            <span *ngIf="customer.active == false"
                                [class]="'customer-badge status-unqualified'">Inactive</span>

                        </td>

                    </tr>
                </ng-template>
                <ng-template pTemplate="emptymessage">
                    <tr>
                        <td colspan="24">No Approvals loans found.</td>
                    </tr>
                </ng-template>
                <ng-template pTemplate="loadingbody">
                    <tr>
                        <td colspan="24">Loading Approvals loans data. Please wait.</td>
                    </tr>
                </ng-template>
            </p-table>
        </div>

    </div>
</div>

<p-dialog [header]="headerText + '   Disbursement' " [(visible)]="isShowForm" [style]="{width:'50rem',height : '35rem'}"
    [maximizable]="false">
    <!-- <p-sidebar > -->
    <div class="grid">
        <div class="col-12">
            <div class="card  p-fluid">
                <div class="grid">
                    <!-- <h5>Disbursement a Loan </h5> -->
                    <!-- <div class="col-12">
                        <label htmlFor="state">Borrower</label>
                        <p-dropdown [options]="borrwoersList" [(ngModel)]="createMaster.borrowername"
                            placeholder="Select Borrower" optionLabel="name" class="ng-invalid ng-dirty"
                            optionValue="_id" [filter]="true" [disabled]="mode=='VIEW' "></p-dropdown>
                        <small *ngIf="createMaster.borrowername != ''">
                            {{ errorMessages.borrowername}}
                        </small>
                    </div>
                   
                    <div class="col-12">
                        <label htmlFor="state">SMT CODE </label>
                        <input pInputText id="age1" type="text" [disabled]="true" [(ngModel)]="createMaster.smtcode" />
                    </div>
                    <div class="col-12">
                        <label htmlFor="state">House type</label>
                        <p-dropdown [options]="houseTypeList" [(ngModel)]="createMaster.housetype" optionLabel="label"
                            optionValue="value" class="ng-invalid ng-dirty" [filter]="true"
                            placeholder="Select House Type" [disabled]="mode=='VIEW' "></p-dropdown>
                        <small *ngIf="errorMessages.housetype != ''">{{ errorMessages.housetype}}</small>
                    </div>
                    <div class="col-12">
                        <label htmlFor="state">Product type</label>
                        <p-dropdown [options]="productTypeList" [(ngModel)]="createMaster.prodtype" optionLabel="label"
                            optionValue="value" class="ng-invalid ng-dirty" [filter]="true" (onChange)="onProducttype()"
                            placeholder="Select Product type" [disabled]="mode=='VIEW' "></p-dropdown>
                        <small *ngIf="errorMessages.prodtype != ''">{{ errorMessages.prodtype}}</small>
                    </div> -->
                    <!-- <div class="col-12">
                        <label htmlFor="state">Deposit List</label>
                        <p-dropdown [options]="despositList" [(ngModel)]="createMaster.deposit" optionLabel="label"
                            optionValue="value" class="ng-invalid ng-dirty" [filter]="true" placeholder="Select Deposit"
                            [disabled]="mode=='VIEW' || createMaster.prodtype != 1 "></p-dropdown>
                        <small *ngIf="errorMessages.deposit != ''">{{ errorMessages.deposit}}</small>
                    </div>
                    <div class="col-12">
                        <label htmlFor="state">Loan Amount </label>
                        <p-dropdown [options]="loanAmountList" [(ngModel)]="createMaster.loanamount" optionLabel="label"
                            optionValue="value" class="ng-invalid ng-dirty" [filter]="true"
                            placeholder="Select Loan Amount" [disabled]="mode=='VIEW' "></p-dropdown>

                    
                        <small *ngIf="errorMessages.loanamount != ''">{{ errorMessages.loanamount}}</small>
                    </div> -->
                    <!-- <div class="col-12">
                        <label htmlFor="state">Repay Mode </label>
                        <p-dropdown [options]="loanShedule" [(ngModel)]="createMaster.loanschedule" optionLabel="label"
                            optionValue="value" class="ng-invalid ng-dirty" [filter]="true"
                            placeholder="Select Repay Mode" [disabled]="mode=='VIEW' "></p-dropdown>
                        <small *ngIf="errorMessages.loanschedule != ''">{{ errorMessages.loanschedule}}</small>
                    </div>
                    <div class="col-12">
                        <label htmlFor="state">Loan tenure </label>
                        <p-dropdown [options]="tenureList" [(ngModel)]="createMaster.tenure" optionLabel="label"
                            optionValue="value" class="ng-invalid ng-dirty" [filter]="true"
                            placeholder="Select Loan Tenture" [disabled]="mode=='VIEW' "></p-dropdown>
                        <small *ngIf="errorMessages.tenure != ''">{{ errorMessages.tenure}}</small>
                    </div>
                    <div class="col-12">
                        <label htmlFor="age1">Bank</label>
                        <input pInputText id="age1" type="text" [disabled]="mode=='VIEW' "
                            [(ngModel)]="createMaster.bankname" class="ng-invalid ng-dirty" />
                        <small *ngIf="errorMessages.bankname != ''">{{ errorMessages.bankname}}</small>
                    </div> -->
                    <!-- <div class="col-12">
                        <label htmlFor="age1">Account no</label>
                        <input pInputText id="age1" type="text" [disabled]="mode=='VIEW' "
                            [(ngModel)]="createMaster.accountno" [maxLength]="18" class="ng-invalid ng-dirty" />
                        <small *ngIf="errorMessages.accountno != ''">{{ errorMessages.accountno}}</small>
                    </div>
                    <div class="col-12">
                        <label htmlFor="age1">Bank Account Name</label>
                        <input pInputText id="age1" type="text" [disabled]="mode=='VIEW' "
                            [(ngModel)]="createMaster.accountname" class="ng-invalid ng-dirty" />
                        <small *ngIf="errorMessages.accountname != ''">{{ errorMessages.accountname}}</small>
                    </div>
                    <div class="col-12">
                        <label htmlFor="age1">IFSC Code</label>
                        <input pInputText id="age1" type="text" [disabled]="mode=='VIEW' "
                            [(ngModel)]="createMaster.ifsc" class="ng-invalid ng-dirty" />
                        <small *ngIf="errorMessages.ifsc != ''">{{ errorMessages.ifsc}}</small>
                    </div>
                    <div class="col-12">
                        <label htmlFor="name1">Surity Name</label>
                        <input pInputText id="name1" type="text" [disabled]="mode=='VIEW' "
                            [(ngModel)]="createMaster.surityname" class="ng-invalid ng-dirty" />
                        <small *ngIf="errorMessages.surityname != ''">{{ errorMessages.surityname}}</small>
                    </div> -->
                    <!-- <div class="col-12">
                        <label htmlFor="name1">Surity Aadhar</label>
                        <p-inputMask mask="9999-9999-9999" [disabled]="mode=='VIEW' "
                            [(ngModel)]="createMaster.surityaadhar" [disabled]="mode=='VIEW'"
                            class="ng-invalid ng-dirty" [pKeyFilter]="'num'" placeholder="2222-2222-2222"></p-inputMask>
                        <small *ngIf="errorMessages.surityaadhar != ''">{{ errorMessages.surityaadhar}}</small>

                    </div>
                    <div class="col-12">
                        <label htmlFor="name1">Surity House type</label>
                        <p-dropdown [options]="houseTypeList" [(ngModel)]="createMaster.surityhousetype"
                            class="ng-invalid ng-dirty" optionLabel="label" optionValue="value" [filter]="true"
                            [disabled]="mode=='VIEW' " placeholder="Select House Type"></p-dropdown>
                        <small *ngIf="errorMessages.surityhousetype != ''">House type is required.</small>
                    </div> -->
                    <!-- <div class="col-12">
                        <label htmlFor="name1">Surity Contact no</label>
                        <input pInputText id="age1" type="text" [(ngModel)]="createMaster.contactnumber"
                            placeholder="999999999" [disabled]="mode=='VIEW' " [minlength]="10" [maxlength]="10"
                            class="ng-invalid ng-dirty" />

                        <small *ngIf="errorMessages.contactnumber != ''">{{ errorMessages.contactnumber}}</small>
                    </div>
                    <div class="col-12">
                        <label htmlFor="name1">Description</label>

                        <textarea rows="5" cols="30" pInputTextarea [disabled]="mode=='VIEW' "
                            [(ngModel)]="createMaster.description"></textarea>

                    </div>
                    <div class="col-12">
                        <input type="checkbox" name="master" id="1" [(ngModel)]="createMaster.active"
                            [disabled]="mode=='VIEW' || mode == 'NEW'">
                        <label for="lastname2" class="ml-2">Active</label>
                    </div> -->

                    <!-- <div class="col-6">
                        <label htmlFor="name1">Loan Repayment Day ( In Month )</label>
                        <input pInputText id="age1" type="text" [(ngModel)]="createMaster.repaymenttype"
                            placeholder="1" [minlength]="1" [maxlength]="2" class="ng-invalid ng-dirty" />

                    </div> -->
                    <div class="col-6">
                        <label htmlFor="name1">Payment Type</label>
                        <p-dropdown [options]="pymentType" [(ngModel)]="createMaster.paymenttype"
                            class="ng-invalid ng-dirty" optionLabel="label" optionValue="value" [filter]="true"
                            placeholder="Select Payment Type" (onChange)="onloanStatusRemarks()"></p-dropdown>
                        <small *ngIf="errorMessages.paymenttype != ''">Payment type is required.</small>
                    </div>
                    <div class="col-6">
                        <label htmlFor="name1">Disbursement Status</label>
                        <p-dropdown [options]="approvalsStatusList" [(ngModel)]="createMaster.disbursementstatus"
                            class="ng-invalid ng-dirty" optionLabel="label" optionValue="value" [filter]="true"
                            placeholder="Select Disbursement Status" (onChange)="onloanStatusRemarks()"></p-dropdown>
                        <small *ngIf="errorMessages.disbursementstatus != ''">Loan Status is required.</small>
                    </div>
                    <div class="col-12">
                        <label htmlFor="name1">{{loanStatusRemarks}} </label>
                        <textarea rows="5" cols="30" pInputTextarea
                            [(ngModel)]="createMaster.disbursementstatusremarks"></textarea>

                        <!-- <small *ngIf="errorMessages.approvalstatus != ''">Loan Status is required.</small> -->
                    </div>
                    <div class="col-12">
                        <div class="grid">
                            <!-- <div class="col-6">
                                <button pButton [disabled]="mode=='VIEW'" pRipple label="Clear" (click)="hideDialog()"
                                    class="p-button-outlined"></button>

                            </div> -->
                            <div class="col-12">
                                <button pButton pRipple label="Submit status" (click)="saveProduct()"
                                    [loading]="submitloading" class="p-button-success"></button>
                            </div>
                        </div>
                    </div>

                </div>
            </div>
        </div>
    </div>
    <!-- </p-sidebar> -->
</p-dialog>

<style>
    :host ::ng-deep .p-cascadeselect-items {
        max-height: 100px;
        overflow: auto;
    }
</style>

<p-toast position="top-right" [breakpoints]="{'920px': {width: '100%', right: '0', left: '0'}}"
    (onClose)="onMessageClose()"></p-toast>