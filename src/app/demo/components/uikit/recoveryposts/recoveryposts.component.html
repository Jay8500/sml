<div class="grid">
    <div class="col-12">
        <div class="card">
            <div class="flex justify-content-between flex-wrap">
                <div class="flex align-items-center justify-content-center w-10rem h-2rem font-bold border-round m-2">
                    Recovery Postings
                </div>
                <div class="flex align-items-center justify-content-center w-0rem h-0 font-bold border-round m-1">
                    <!-- 2 -->
                </div>
                <!-- <div class="flex align-items-center justify-content-center w-10rem h-2rem font-bold border-round m-2">
                    <button pButton pRipple label="Add new" [loading]=false class="p-button-success"
                        (click)="onClick(null,'NEW')"></button>
                </div> -->
            </div>


            <p-table #dt1 [value]="crudGrid" dataKey="smtcode" [rows]="10" [loading]="loading" [rowHover]="true"
                styleClass="p-datatable-gridlines" [showCurrentPageReport]="true" [paginator]="true"
                responsiveLayout="scroll">
                <ng-template pTemplate="header">
                    <tr>
                        <th style="min-width: 12rem">
                            <div class="flex justify-content-between align-items-center">
                                SMT CODE
                                <p-columnFilter type="text" field="smtcode" display="menu"
                                    placeholder="Search by SML CODE"></p-columnFilter>
                            </div>
                        </th>

                        <th style="min-width: 22rem">
                            <div class="flex justify-content-between align-items-center">
                                Name
                                <!-- <p-columnFilter type="text" field="borrower" display="menu"
                                    placeholder="Search by name"></p-columnFilter> -->
                            </div>
                        </th>

                        <th style="min-width: 8rem">
                            <div class="flex justify-content-between align-items-center">
                                Tenure
                                <!-- <p-columnFilter type="text" field="borrower" display="menu"
                                    placeholder="Search by name"></p-columnFilter> -->
                            </div>
                        </th>

                        <th style="min-width: 5rem">
                            <div class="flex justify-content-between align-items-center">
                                Repay Mode
                                <!-- <p-columnFilter type="text" field="prodtypeName" display="menu"
                                    placeholder="Search by Product type"></p-columnFilter> -->
                            </div>
                        </th>

                        <th style="min-width: 10rem">
                            <div class="flex justify-content-between align-items-center">
                               Borrowed Amount
                                <!-- Due Amount -->
                                <!-- <p-columnFilter type="text" field="loanamount" display="menu"
                                    placeholder="Search by Loan amount"></p-columnFilter> -->
                            </div>
                        </th>
                        <th style="min-width: 10rem">
                            <div class="flex justify-content-between align-items-center">
                               EMI
                                <!-- Due Amount -->
                                <!-- <p-columnFilter type="text" field="loanamount" display="menu"
                                    placeholder="Search by Loan amount"></p-columnFilter> -->
                            </div>
                        </th>
                        <th style="min-width: 8rem">
                            <div class="flex justify-content-between align-items-center">
                                Past due
                                <!-- Due Amount -->
                                <!-- <p-columnFilter type="text" field="loanamount" display="menu"
                                    placeholder="Search by Loan amount"></p-columnFilter> -->
                            </div>
                        </th>
                        <th style="min-width: 8rem">
                            <div class="flex justify-content-between align-items-center">
                                Current due
                                <!-- Due Amount -->
                                <!-- <p-columnFilter type="text" field="loanamount" display="menu"
                                    placeholder="Search by Loan amount"></p-columnFilter> -->
                            </div>
                        </th>
                        <th style="min-width: 8rem">
                            <div class="flex justify-content-between align-items-center">
                                Total due
                                <!-- Due Amount -->
                                <!-- <p-columnFilter type="text" field="loanamount" display="menu"
                                    placeholder="Search by Loan amount"></p-columnFilter> -->
                            </div>
                        </th>
                        <th style="min-width: 10rem">
                            <div class="flex justify-content-between align-items-center">
                                Collected Amount
                                <!-- <p-columnFilter type="text" field="loanamount" display="menu"
                                    placeholder="Search by Loan amount"></p-columnFilter> -->
                            </div>
                        </th>
                        <th style="min-width: 6rem">
                            <div class="flex justify-content-between align-items-center">
                                Payment Type
                                <!-- <p-columnFilter type="text" field="status" display="menu"
                                    placeholder="Search by Suriy Status"></p-columnFilter> -->
                            </div>
                        </th>
                        <th style="min-width: 10rem">
                            <div class="flex justify-content-between align-items-center">
                                Action
                                <!-- <p-columnFilter type="text" field="status" display="menu"
                                    placeholder="Search by Suriy Status"></p-columnFilter> -->
                            </div>
                        </th>
                    </tr>
                </ng-template>
                <ng-template pTemplate="body" let-customer let-cusId="rowIndex">
                    <tr>
                        <td>
                            <i class="pi pi-history" pTooltip="Payment History" *ngIf="customer.paymentHistory"
                                (click)="historyLookup(customer)"></i>
                            <span style="color: blue;font-size: medium;">
                                {{customer.smtcode}}
                            </span>
                        </td>
                        <td>
                            {{customer.borrower}}
                        </td>

                        <td>
                            {{customer.tenureName}}
                        </td>
                        <td>
                            {{customer.loanscheduleName}}
                        </td>
                        <td>
                            {{customer.loanAmountName}}
                        </td>
                        <td>
                            {{customer.emi}}
                        </td>
                        <td>
                            {{customer.pastDue}}
                        </td>
                        <td>
                            {{customer.currentDue}}
                        </td>
                        <td>
                            {{customer.loanAmountName}}
                        </td>
                        <td>
                            <div class="mb-3 w-full">
                                <input pInputText id="age1" type="text" [(ngModel)]="customer.collectedloanAmount"
                                    [pKeyFilter]="'num'" maxlength="10" (blur)="collectedAmount(customer)" />
                            </div>
                            <div>
                                <small *ngIf="customer.error  != ''">{{customer.error}}</small>
                            </div>
                        </td>
                        <td>
                            <div *ngFor="let paymentType of paymentTypeList ">
                                <input type="radio" name="test_{{cusId}}" id="1" [value]="paymentType.value"
                                    [(ngModel)]="customer.collectedPaymentType">{{paymentType.label}}
                            </div>
                        </td>
                        <td>
                            <button pButton label="Save payment" class="w-full " [loading]="loadings"
                                styleClass="p-button-rounded " (click)="save()"></button>
                        </td>

                    </tr>
                </ng-template>
                <ng-template pTemplate="emptymessage">
                    <tr>
                        <td colspan="8">Recovery Postings found.</td>
                    </tr>
                </ng-template>
                <ng-template pTemplate="loadingbody">
                    <tr>
                        <td colspan="8">Loading Recovery Postings data. Please wait.</td>
                    </tr>
                </ng-template>
            </p-table>

        </div>

    </div>
</div>


<p-toast position="top-right" [breakpoints]="{'920px': {width: '100%', right: '0', left: '0'}}"
    (onClose)="onMessageClose()"></p-toast>


<p-sidebar [(visible)]="sidebarVisible" [fullScreen]="true" #sidebarRef [showCloseIcon]="false">
    <ng-template pTemplate="headless">
        <div class="flex flex-column h-full">
            <div class="flex align-items-center justify-content-between px-4 pt-3 flex-shrink-0">
                <span class="inline-flex align-items-center gap-2">
                    <span class="font-semibold text-2xl text-primary">Payment History of {{ historyHeader }}</span>
                </span>
                <span>
                    <p-button type="button" (click)="closeCallback($event)" icon="pi pi-times" rounded="true"
                        outlined="true" styleClass="h-2rem w-2rem"></p-button>
                </span>
            </div>
            <div class="overflow-y-auto">
                <ul class="list-none p-3 m-0">
                    <li>
                        <ul class="list-none p-0 m-0 overflow-hidden">
                            <li>
                                <a pRipple
                                    class="flex align-items-center cursor-pointer p-3 border-round text-700 hover:surface-100 transition-duration-150 transition-colors p-ripple">
                                    <i class="pi pi-home mr-2"></i>
                                    <span class="font-medium">Dashboard</span>
                                </a>
                            </li>
                        </ul>
                    </li>
                </ul>
            </div>
        </div>
    </ng-template>
</p-sidebar>